<html>
  <!-- http://slicker.me/javascript/particles.htm inspired me to start this -->

  <head>
    <link rel="stylesheet" href="./line.css" />
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  </head>
  <body>

    <div id="app">
      <div>
        <space-control-panel :space="idToSpace['milky']" />
      </div>
    </div>

    <script>
     Vue.component('space-control-panel', {
       props: ["space"],
       template: `<div>id: {{space.id}}</div>`,
     });
    </script>




    <div id="milky-simulation" class="space-simulation">
      <div>

        <div class="space-viewport">
          <canvas id="milky" class="galaxy" width="640" height="480"></canvas>
        </div>

        <div class="control-panel">
          <form>
            <p><b>Field</b></p>
            <ul>
              <li><label><input type="checkbox" name="drawFieldVector" checked>Vector</label></li>
              <li><label><input type="checkbox" name="drawFieldStrength">Strength</label></li>
              <li><label><input type="checkbox" name="isFieldInverted">Inverted</label></li>
            </ul>

            <p><b>Star</b></p>
            <ul>
              <li>Count <input type="number" name="starCount" autocomplete="off" step="10" min="0" max="4000" /> </li>
              <li><label><input type="checkbox" name="drawStarTail" checked>Tail</label></li>
              <li><label><input type="checkbox" name="drawStarsLine" checked>Snap</label></li>
            </ul>
          </form>
          <form>
            <button class="restart-simulation">Restart stars</button>
          </form>

          <div class="displayTotal">Total dx: <span class="displayTotalX"></span>
          <div class="displayTotal">Total dy: <span class="displayTotaly"></span>
        </div>

      </div>
    </div>


    <div>
      <canvas id="andromeda" class="galaxy" width="100" height="100"></canvas>
    </div>

  </body>

  <script src="./lib/simulation.js"></script>
  <script src="./lib/space.js"></script>
  <script src="./lib/field.js"></script>
  <script src="./lib/star.js"></script>
  <script>
   "use strict";

   const milkySpace = new Space({
     id: "milky",
     starCount: 25,
     blackHoleGravity: 0,
     drawStarTail: true,
     drawStarsLine: true,
     maxDistance: 60,
     drawFieldVector: true,
     drawFieldStrength: false,
     isFieldInverted: false,
   });
   const milkySimulation = new Simulation({
     id: "milky-simulation",
     space: milkySpace,
   });


   const simulations = [ milkySimulation ];

   const spaces = [
     new Space({
       id: "andromeda",
       starCount: 4,
       maxDistance: 20,
       blackHoleGravity: 4,
     }),
     milkySpace,
   ];

   function passTime() {
     for (let space of spaces) {
       space.passTime();
     }

     window.requestAnimationFrame(passTime);
   }
   passTime();

   function updateSimulations() {
     simulations.forEach( simulation => simulation.updateDisplay() );
   }
   setInterval(updateSimulations, 2000);

  </script>


  <script>
   // vue app
   const vm = new Vue({
     el: "#app",
     data: {
       idToSpace: {
         milky: milkySpace,
       },
     },
   });
  </script>
</html>
