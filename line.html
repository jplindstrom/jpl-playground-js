<html>
  <style>
   body {
     background: #000;
   }

   .galaxy {
     margin: 1em;
   }
  </style>

  <body>
    <canvas id="andromeda" class="galaxy" width="100" height="100"></canvas>
    <canvas id="milky" class="galaxy" width="640" height="480"></canvas>
  </body>

  <script>


   function Space(id, starCount = 100) {

     const canvas = document.getElementById(id);
     const c = canvas.getContext("2d");

     const width = canvas.width;
     const height = canvas.height;

     const stars = Array(starCount).fill().map(
       () => new Star(
         Math.floor(Math.random() * width),
         Math.floor(Math.random() * height),
       ),
     );

     return {
       stars: stars,
       canvas: canvas,
       c: c,
       width: width,
       height: height,

       passTime: function() {
         for (star of this.stars) {
           star.move(this);
         }

         this.draw();
       },

       draw: function() {
         this.c.clearRect(0, 0, this.canvas.width, this.canvas.height)

         // Draw stars
         for (star of this.stars) {
           star.draw(this.c);
         }

         // Draw lines between stars
         this.drawStarLines();
       },

       drawStarLines: function() {
         this.c.strokeStyle = 'rgb(100, 100, 100)';
         let lastStar = this.stars[ this.stars.length - 1 ];
         for (star of this.stars) {
           this.drawStarLine(star, lastStar);
           lastStar = star;
         }
       },

       drawStarLine: function(star1, star2) {
         this.drawLine(star1.x, star1.y, star2.x, star2.y);
       },

       drawLine: function(x1, y1, x2, y2) {
         const c = this.c;
         c.beginPath();
         c.moveTo(x1, y1);
         c.lineTo(x2, y2);
         c.stroke();
         c.closePath();
       }
     };
   }

   function Star(x, y, size = 2, color = 'rgb(200, 200, 200)') {
     const randomD = function() {
       const d = ((Math.random() - 0.5) * 0.7) + 0.1;
       // console.log(d);
       return d;
     };
     const dx = randomD();
     const dy = randomD();
     return {
       x: x,
       y: y,
       size: size,
       color: color,
       dx: dx,
       dy: dy,

       move: function(space) {
         this.x = this.moveDimension(this.x, this.dx, space.width);
         this.y = this.moveDimension(this.y, this.dy, space.height);
       },

       moveDimension: function(d, dd, dMax) {
         d += dd;
         if (d < 0) { d = dMax }
         else if (d > dMax) { d = 0 }
         return d;
       },

       draw: function(c) {
         c.fillStyle = this.color;
         const sizeOffset = this.size / 2;
         c.fillRect(this.x - sizeOffset, this.y - sizeOffset, this.size, this.size);
       }
     };
   }


   const galaxies = [
     new Space("andromeda", 10),
     new Space("milky", 30),
   ];

   function passTime() {
     for (galaxy of galaxies) {
       galaxy.passTime();
     }

     window.requestAnimationFrame(passTime);
   }

   passTime();


  </script>
</html>
